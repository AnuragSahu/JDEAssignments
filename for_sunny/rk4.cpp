#include <iostream>
#include <vector>
#include<bits/stdc++.h> 


using namespace std;

float f(float t,float i,float s)
{
    return (-20000*i - 94*s);
}

float g(float t,float i,float s)
{
    return s;
}

int main()
{
    int setpre = 4;
    bool Debug = true;
    bool print_intermediacte = true;
    
    float h = 0.002; // Subinterval
    float t = 0;
    float t1 = 0;
    float i = 0;
    float s = 300;
    
    cout << "Enter i : ";
    cin >> i;
    
    cout << "Enter s : ";
    cin >>  s;
    
    cout << "Enter time interval : ";
    cin >>  h;
    t1 = h;
    
    
    
    vector<float> times;
    for(int looper = 0; looper < 5; looper++){
        times.push_back(float(looper * h));
    }
    
            
            
    for(int looper = 0; looper < 5; looper++){
        
        t = times[looper];
        
        if(Debug){
            cout << "i = " << i << ", s = " << s << ",t = " << t+t1 << "\n";
        }
        
        float k1 = h*f(t,i,s);
        float l1 = h*g(t,i,s);
        
        if(Debug)
            cout <<"k1 : "<< fixed << setprecision(setpre)<< k1 << " ,l1 : " << l1 << "\n";
        
        float k2 = f(t+h/2,i+k1/2,s+l1/2);
        k2*=h;
        float l2 = h*g(t+h/2,i+k1/2,s+l1/2);
        
        if(Debug)
            cout <<"k2 : " << k2 << " ,l2 : " << l2 << "\n";
        
        float k3 = h*f(t+h/2,i+k2/2,s+l2/2);
        float l3 = h*g(t+h/2,i+k2/2,s+l2/2);
        
        if(Debug)
            cout <<"k3 : "<< fixed << setprecision(setpre)<< k3 << " ,l3 : " << l3 << "\n";
        
        float k4 = h*f(t+h,i+k3,s+l3);
        float l4 = h*g(t+h,i+k3,s+l3);
        
        if(Debug)
            cout <<"k4 : "<< fixed << setprecision(setpre)<< k4 << " ,l4 : " << l4 << "\n";
        
        float I1 = (l1 + 2*l2 + 2*l3 + l4) / 6 + i;
        float S1 = s + ((k1 + 2*k2 + 2*k3 + k4)/6);
        
        
        if(print_intermediacte)
            cout <<"I1 : "<< I1 << ", S1 : " << S1 << "\n";
            
        i = I1;
        s = S1;
        
        cout << "\n\n";
        
    }
    return 0;
}


/****
Enter i : Enter s : Enter time interval : i = 0, s = 300,t = 0.02
k1 : -564.0000 ,l1 : 6.0000
k2 : 112230.3594 ,l2 : 6.0600
k3 : -22446642.0000 ,l3 : 6.0606
k4 : 8978656256.0000 ,l4 : 6.1212
I1 : 6.0604, S1 : 1488998144.0000


i = 6.0604, s = 1488998144.0000,t = 0.0400
k1 : -2799318784.0000 ,l1 : 29779962.0000
k2 : 557036470272.0000 ,l2 : 30077762.0000
k3 : -111410117869568.0000 ,l3 : 30080740.0000
k4 : 44564043792384000.0000 ,l4 : 30381578.0000
I2 : 30079764.0000, S2 : 7390390491545600.0000


i = 30079764.0000, s = 7390390491545600.0000,t = 0.0600
k1 : -13893946472136704.0000 ,l1 : 147807809830912.0000
k2 : 2764756347781120000.0000 ,l2 : 149285882560512.0000
k3 : -552965332309943255040.0000 ,l3 : 149300663287808.0000
k4 : 221186099146980096737280.0000 ,l4 : 150793818734592.0000
I3 : 149295814672384.0000, S3 : 36680954273804234784768.0000


i = 149295814672384.0000, s = 36680954273804234784768.0000,t = 0.0800
k1 : -68960252401403132116992.0000 ,l1 : 733619068587586093056.0000
k2 : 13722400330459505659740160.0000 ,l2 : 740955221274340098048.0000
k3 : -2744549674880663274941054976.0000 ,l3 : 741028615874517401600.0000
k4 : 1097819718836537858147775152128.0000 ,l4 : 748439640905076441088.0000
I4 : 741004549764008640512.0000, S4 : 182059713851605530329925812224.0000


i = 741004549764008640512.0000, s = 182059713851605530329925812224.0000,t = 0.1000
k1 : -342272551427636467272119222272.0000 ,l1 : 3641194253420278192250290176.0000
k2 : 68108815831788305916315557691392.0000 ,l2 : 3677606355334349771023319040.0000
k3 : -13622107739230471023329002991386624.0000 ,l3 : 3677969977553530733704773632.0000
k4 : 5448842719358416466575997627220885504.0000 ,l4 : 3714753670680223117685555200.0000
I5 : 3677850737799838275163127808.0000, S5 : 903622625715351849106736281190137856.0000




**/
